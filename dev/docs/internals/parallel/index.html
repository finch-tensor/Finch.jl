<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Parallel Processing in Finch · Finch.jl</title><meta name="title" content="Parallel Processing in Finch · Finch.jl"/><meta property="og:title" content="Parallel Processing in Finch · Finch.jl"/><meta property="twitter:title" content="Parallel Processing in Finch · Finch.jl"/><meta name="description" content="Documentation for Finch.jl."/><meta property="og:description" content="Documentation for Finch.jl."/><meta property="twitter:description" content="Documentation for Finch.jl."/><meta property="og:url" content="https://finch-tensor.github.io/Finch.jl/docs/internals/parallel/"/><meta property="twitter:url" content="https://finch-tensor.github.io/Finch.jl/docs/internals/parallel/"/><link rel="canonical" href="https://finch-tensor.github.io/Finch.jl/docs/internals/parallel/"/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img src="../../../assets/logo.png" alt="Finch.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">Finch.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><a class="tocitem" href="../../../getting_started/">Getting Started</a></li><li><span class="tocitem">Documentation</span><ul><li><a class="tocitem" href="../../tensor_formats/">Tensor Formats</a></li><li><a class="tocitem" href="../../array_api/">High-Level Array API</a></li><li><a class="tocitem" href="../../sparse_utils/">Sparse and Structured Utilities</a></li><li><a class="tocitem" href="../../user-defined_functions/">User-Defined Functions</a></li><li><a class="tocitem" href="../../fileio/">FileIO</a></li><li><input class="collapse-toggle" id="menuitem-3-6" type="checkbox"/><label class="tocitem" for="menuitem-3-6"><span class="docs-label">Advanced: Finch Language</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../language/calling_finch/">Calling Finch</a></li><li><a class="tocitem" href="../../language/finch_language/">The Finch Language</a></li><li><a class="tocitem" href="../../language/dimensionalization/">Dimensionalization</a></li><li><a class="tocitem" href="../../language/index_sugar/">Index Sugar</a></li><li><a class="tocitem" href="../../language/mask_sugar/">Mask Sugar</a></li><li><a class="tocitem" href="../../language/iteration_protocols/">Iteration Protocols</a></li><li><a class="tocitem" href="../../language/parallelization/">Parallelization</a></li><li><a class="tocitem" href="../../language/interoperability/">Interoperability</a></li><li><a class="tocitem" href="../../language/optimization_tips/">Optimization Tips</a></li><li><a class="tocitem" href="../../language/benchmarking_tips/">Benchmarking Tips</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-7" type="checkbox"/><label class="tocitem" for="menuitem-3-7"><span class="docs-label">Developers: Internal Details</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../virtualization/">Virtualization</a></li><li><a class="tocitem" href="../tensor_interface/">Tensor Interface</a></li><li><a class="tocitem" href="../compiler_interface/">Compiler Interfaces</a></li><li><a class="tocitem" href="../finch_notation/">Finch Notation</a></li><li><a class="tocitem" href="../finch_logic/">Finch Logic</a></li></ul></li></ul></li><li><a class="tocitem" href="../../../CONTRIBUTING/">Community and Contributions</a></li><li><span class="tocitem">Appendices and Additional Resources</span><ul><li><a class="tocitem" href="../../../appendices/directory_structure/">Directory Structure</a></li><li><a class="tocitem" href="../../../appendices/directory_structure/">Code Listing</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Parallel Processing in Finch</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Parallel Processing in Finch</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/finch-tensor/Finch.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/finch-tensor/Finch.jl/blob/main/docs/src/docs/internals/parallel.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Parallel-Processing-in-Finch"><a class="docs-heading-anchor" href="#Parallel-Processing-in-Finch">Parallel Processing in Finch</a><a id="Parallel-Processing-in-Finch-1"></a><a class="docs-heading-anchor-permalink" href="#Parallel-Processing-in-Finch" title="Permalink"></a></h1><h2 id="Modelling-the-Architecture"><a class="docs-heading-anchor" href="#Modelling-the-Architecture">Modelling the Architecture</a><a id="Modelling-the-Architecture-1"></a><a class="docs-heading-anchor-permalink" href="#Modelling-the-Architecture" title="Permalink"></a></h2><p>Finch uses a simple, hierarchical representation of devices and tasks to model different kind of parallel processing. An <a href="#Finch.AbstractDevice"><code>AbstractDevice</code></a> is a physical or virtual device on which we can execute tasks, which may each be represented by an <a href="#Finch.AbstractTask"><code>AbstractTask</code></a>.</p><article><details class="docstring" open="true"><summary id="Finch.AbstractTask"><a class="docstring-binding" href="#Finch.AbstractTask"><code>Finch.AbstractTask</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">AbstractTask</code></pre><p>An individual processing unit on a device, responsible for running code.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/finch-tensor/Finch.jl/blob/1860c26a2d84aaa1de6d564f383c72be44303f0f/src/architecture.jl#L30-L34">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Finch.AbstractDevice"><a class="docstring-binding" href="#Finch.AbstractDevice"><code>Finch.AbstractDevice</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">AbstractDevice</code></pre><p>A datatype representing a device on which tasks can be executed.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/finch-tensor/Finch.jl/blob/1860c26a2d84aaa1de6d564f383c72be44303f0f/src/architecture.jl#L1-L5">source</a></section></details></article><p>The current task in a compilation context can be queried with <a href="../compiler_interface/#Finch.get_task"><code>get_task</code></a>. Each device has a set of numbered child tasks, and each task has a parent task.</p><article><details class="docstring" open="true"><summary id="Finch.get_num_tasks"><a class="docstring-binding" href="#Finch.get_num_tasks"><code>Finch.get_num_tasks</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">get_num_tasks(dev::AbstractDevice)</code></pre><p>Return the number of tasks on the device dev.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/finch-tensor/Finch.jl/blob/1860c26a2d84aaa1de6d564f383c72be44303f0f/src/architecture.jl#L38-L42">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Finch.get_task_num"><a class="docstring-binding" href="#Finch.get_task_num"><code>Finch.get_task_num</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">get_task_num(task::AbstractTask)</code></pre><p>Return the task number of <code>task</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/finch-tensor/Finch.jl/blob/1860c26a2d84aaa1de6d564f383c72be44303f0f/src/architecture.jl#L45-L49">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Finch.get_device"><a class="docstring-binding" href="#Finch.get_device"><code>Finch.get_device</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">get_device(task::AbstractTask)</code></pre><p>Return the device that <code>task</code> is running on.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/finch-tensor/Finch.jl/blob/1860c26a2d84aaa1de6d564f383c72be44303f0f/src/architecture.jl#L52-L56">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Finch.get_parent_task"><a class="docstring-binding" href="#Finch.get_parent_task"><code>Finch.get_parent_task</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">get_parent_task(task::AbstractTask)</code></pre><p>Return the task which spawned <code>task</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/finch-tensor/Finch.jl/blob/1860c26a2d84aaa1de6d564f383c72be44303f0f/src/architecture.jl#L59-L63">source</a></section></details></article><h2 id="Data-Transfer"><a class="docs-heading-anchor" href="#Data-Transfer">Data Transfer</a><a id="Data-Transfer-1"></a><a class="docs-heading-anchor-permalink" href="#Data-Transfer" title="Permalink"></a></h2><p>Before entering a parallel loop, a tensor may reside on a single task, or represent a single view of data distributed across multiple tasks, or represent multiple separate tensors local to multiple tasks. A tensor&#39;s data must be resident in the current task to process operations on that tensor, such as loops over the indices, accesses to the tensor, or <code>declare</code>, <code>freeze</code>, or <code>thaw</code>. Upon entering a parallel loop, we must transfer the tensor to the tasks where it is needed. Upon exiting the parallel loop, we may need to combine the data from multiple tasks into a single tensor.</p><p>All tensor and buffer transfers are accomplished with the <code>transfer</code> function.</p><p>The <code>distribute</code> function is used by the compiler to orchestrate data distribution before and after a parallel region, with</p><p>different <code>style</code> objects signaling the type of transfer.</p><p>Note: After distributing a tensor, we must also update any in-progress traversals over the tensor that may appear throughout the program. This is done with the <code>redistribute</code> function. Tensors are responsible for defining their own redistribute behavior, but it should be guaranteed that <code>distribute(tns, diff) == redistribute(tns, diff)</code>. In general, this means that any nested structure in the tensor should be preserved through transfers. Most subtensors will store a list of property names describing how to reach the subtensor from the root tensor.</p><article><details class="docstring" open="true"><summary id="Finch.distribute"><a class="docstring-binding" href="#Finch.distribute"><code>Finch.distribute</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">distribute(ctx, arr, device, diff, style)</code></pre><p>If the virtual array is not on the given device, copy the array to that device. This function may modify underlying data arrays, but cannot change the virtual itself. This function is used to move data to the device before a kernel is launched. Since this function may modify the root node, iterators in-progress may need to be updated. We can store new root objects in the <code>diff</code> dictionary.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/finch-tensor/Finch.jl/blob/1860c26a2d84aaa1de6d564f383c72be44303f0f/src/architecture.jl#L296-L304">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Finch.redistribute"><a class="docstring-binding" href="#Finch.redistribute"><code>Finch.redistribute</code></a> — <span class="docstring-category">Function</span></summary><section><div><p>redistribute(ctx, node, diff)</p><pre><code class="language-julia hljs">When the root node is distributed, several iterators may need to be updated.</code></pre><p>The <code>redistribute</code> function traverses <code>tns</code> and updates it based on the updated objects in the <code>diff</code> dictionary.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/finch-tensor/Finch.jl/blob/1860c26a2d84aaa1de6d564f383c72be44303f0f/src/architecture.jl#L307-L313">source</a></section></details></article><p>The <code>distribute</code> function is called on the <code>Host</code> and on the <code>Device</code>, and is responsible for distributing the tensor among tasks and collecting the results, if applicable.</p><p>If the tensor is a temporary tensor declared within the parallel loop, we distribute the tensor to <code>Local</code> scope. If the tensor is declared outside the parallel loop and is not modified, we distribute the tensor to <code>Global</code> scope. If the tensor is declared outside the parallel loop and is modified, we distribute the tensor to <code>Shared</code> scope. Depending on the architecture, several of these operations may be no-ops.</p><article><details class="docstring" open="true"><summary id="Finch.HostLocal"><a class="docstring-binding" href="#Finch.HostLocal"><code>Finch.HostLocal</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">HostLocal()</code></pre><p>From the host, distribute the tensor to device local memory.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/finch-tensor/Finch.jl/blob/1860c26a2d84aaa1de6d564f383c72be44303f0f/src/architecture.jl#L328-L332">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Finch.HostGlobal"><a class="docstring-binding" href="#Finch.HostGlobal"><code>Finch.HostGlobal</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">HostGlobal()</code></pre><p>From the host, distribute the tensor to device global memory.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/finch-tensor/Finch.jl/blob/1860c26a2d84aaa1de6d564f383c72be44303f0f/src/architecture.jl#L356-L360">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Finch.HostShared"><a class="docstring-binding" href="#Finch.HostShared"><code>Finch.HostShared</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">HostShared()</code></pre><p>From the host, distribute the tensor to device shared memory.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/finch-tensor/Finch.jl/blob/1860c26a2d84aaa1de6d564f383c72be44303f0f/src/architecture.jl#L342-L346">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Finch.DeviceLocal"><a class="docstring-binding" href="#Finch.DeviceLocal"><code>Finch.DeviceLocal</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">DeviceLocal()</code></pre><p>From the device, load the local version of the tensor.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/finch-tensor/Finch.jl/blob/1860c26a2d84aaa1de6d564f383c72be44303f0f/src/architecture.jl#L335-L339">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Finch.DeviceGlobal"><a class="docstring-binding" href="#Finch.DeviceGlobal"><code>Finch.DeviceGlobal</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">DeviceGlobal()</code></pre><p>From the device, load the global view of the tensor.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/finch-tensor/Finch.jl/blob/1860c26a2d84aaa1de6d564f383c72be44303f0f/src/architecture.jl#L363-L367">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Finch.DeviceShared"><a class="docstring-binding" href="#Finch.DeviceShared"><code>Finch.DeviceShared</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">DeviceShared()</code></pre><p>From the device, load the shared view of the tensor.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/finch-tensor/Finch.jl/blob/1860c26a2d84aaa1de6d564f383c72be44303f0f/src/architecture.jl#L349-L353">source</a></section></details></article><p>The <code>transfer</code> function is used to distribute tensors and their constituent buffers to different memory spaces.  We can ask for the default local, shared, or global memory spaces of an <code>AbstractDevice</code> with the <code>local_memory</code>, etc. trait functions.</p><article><details class="docstring" open="true"><summary id="Finch.transfer"><a class="docstring-binding" href="#Finch.transfer"><code>Finch.transfer</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">transfer(device, arr)</code></pre><p>If the array is not on the given device, it creates a new version of this array on that device and copies the data in to it, according to the <code>device</code> trait. If the device is simply a data buffer, we copy the array into the buffer.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/finch-tensor/Finch.jl/blob/1860c26a2d84aaa1de6d564f383c72be44303f0f/src/architecture.jl#L287-L293">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Finch.local_memory"><a class="docstring-binding" href="#Finch.local_memory"><code>Finch.local_memory</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">local_memory(dev::AbstractDevice)</code></pre><p>Return the default local memory space of <code>dev</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/finch-tensor/Finch.jl/blob/1860c26a2d84aaa1de6d564f383c72be44303f0f/src/architecture.jl#L9-L13">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Finch.shared_memory"><a class="docstring-binding" href="#Finch.shared_memory"><code>Finch.shared_memory</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">shared_memory(dev::AbstractDevice)</code></pre><p>Return the default shared memory space of <code>dev</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/finch-tensor/Finch.jl/blob/1860c26a2d84aaa1de6d564f383c72be44303f0f/src/architecture.jl#L16-L20">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Finch.global_memory"><a class="docstring-binding" href="#Finch.global_memory"><code>Finch.global_memory</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">global_memory(dev::AbstractDevice)</code></pre><p>Return the default global memory space of <code>dev</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/finch-tensor/Finch.jl/blob/1860c26a2d84aaa1de6d564f383c72be44303f0f/src/architecture.jl#L23-L27">source</a></section></details></article></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Monday 16 February 2026 18:51">Monday 16 February 2026</span>. Using Julia version 1.12.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
